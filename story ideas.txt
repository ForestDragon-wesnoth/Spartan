------------------------------------------------------------------------------------
WARNING: MASSIVE SPOILERS AHEAD
------------------------------------------------------------------------------------
































------------------------------------------------------------------------------------
YOU HAVE BEEN WARNED
------------------------------------------------------------------------------------

Story structure concept (written with help from Mechanical)

Prologue:
1. takes place in Spartan's home world, cutscene where he and a squad of hoplites fights the Main Antagonist
2. main antagonist creates a portal and flees, one (or two in multiplayer) hoplite(s) aka main character(s) chase the antagonist, and just barely get in
3. the cave is actually the main antagonist's old lair
4. protagonist wakes up in Irdya, mentor character (maybe saurian oracle) explains the situation
5. tutorial starts, then protagonist goes into the cave


Tutorial:
-mentor character could be a Saurian Oracle maybe
-mentor could secretly be controlled by The Merchant, to inform the hoplite about the "main antagonist" puppet and thus start the quest

Time Loop:
-campaign being replayed multiple times is actually canon. the cave is stuck in an endless time loop, that resets when the Spartan either dies or defeats the "final boss"
-Most characters do not remember what happens in previous playthroughs, however, the Merchant does

Artifact:
-instead of the current system of "you take artifact at depth 40 and can continue with it", you will get the artifact right in the final boss room
-artifact is used by the Main Antagonist for opening portals and summoning minions from them (might even add a robot world for later biomes)
-UPD: maybe even remove the artifact altogether, or replace it with some other way to get a +50 Energy buff

"Main Antagonist" (most likely female):
-race/origin concept:
 -she is some sort of living statue made out of marble, made alive by magic in Irdya
 -her creator is someone able to travel between worlds
 -she tries to find her creator, then the Merchant tricks her into a pact
  -she gets power/ability to travel between worlds/open portals, but the Merchant mind-controls her
 -twist could be that the merchant has secretly killed her creator some time before the events of the campaign
 -she then invades Sparta since the Merchant influenced her to do, setting the events of the campaign in motion
-very good at magic, able to mind control large amounts of enemies
-goal is conquering Irdya and eventually other worlds
-can be fought in depth 40, or at some intervals later on
 -if the hoplite fights the boss later, he does get more upgrades, but in return the boss gains stronger stats (maybe even some new tricks later on) too
-fight has multiple phases
-is unaware of the Merchant's involvement in the whole situation
-a large of amount of his power is secretly given by the Merchant
-idea:
 -if the Spartan goes deep enough in the caves, he may run into the Main Antagonist, and convince the antagonist about the time loop
  -after that, Main Antagonist loses much of his/her powers, but ends up switching sides and joins the Spartan as a companion
   -enemies in the cave become mind-controlled directly by the Merchant instead
   -motivation for switching sides could be that Merchant secretly killed her creator some time before the story begins

The Merchant:
-the merchant is secretly the true final boss at depth 100, has extremely strong stats/abilities/ranged attacks, is multiphase, similarly to the normal final boss fight
-he is actually responsible for the time loop
-Orbs of Insight are harvested via kills, concentrating the dead unit's power (plus maybe some other factor related to the cave itself?), so the purpose of the time loop is to have the Spartan kill enemies/bosses over and over for the Merchant, so he doesn't need to put in the effort himself
-acts friendly with the Spartan (for some time), sells various things in return for orbs
-the Mentor from the tutorial is secretly The Merchant himself in disguise
 -to get the point across, when the secret is revealed, he could transform back and forth in from of the Spartan in the true ending path
  -like "There was never a [INSERT_MENTOR_NAME] this whole time, only me."
-dialog from previous merchant lines that should be later moved to the end, as part of the big reveal:

            [message]
                speaker=merchant
                message=_"Do you perhaps notice how, when you enter the cave, sometimes <span color='#a456ff'>Orbs of Insight</span> just appear out of thin air into your pocket?"
            [/message]
            [message]
                id=Hoplite,Hoplite2
                message=_"Now that you mention it, I did notice that..."
            [/message]
            [message]
                speaker=merchant
                message=_"Time is not the simple one-directional flow many think it is, certainly not in this place."
            [/message]
            {IF_VAR spartan_orbshop_data1.visited_across_playthroughs greater_than 5 (
            [then]
            [message]
                id=Hoplite
                message=_"I wonder... how many times have we 'met for the first time'?"
            [/message]
            [message]
                speaker=merchant
                message=_"It is precisely $spartan_orbshop_data1.visited_across_playthroughs| times, <span size='small'><i>at least in this subcategory of timelines</i></span>."
            [/message]
            #ifdef MULTIPLAYER
            [message]
                id=Hoplite2
                message=_"And what about me?"
            [/message]
            [message]
                speaker=merchant
                message=_"$spartan_orbshop_data2.visited_across_playthroughs| times in your case."
            [/message]
            #endif
            [message]
                id=Hoplite
                message=_"Wow... that is quite something... and how many orbs have I spent in your shop total?"
            [/message]
            [message]
                speaker=merchant
                message=_"It is exactly $spartan_orbshop_data1.orbs_spent| orbs."
            [/message]
            #ifdef MULTIPLAYER
            [message]
                id=Hoplite2
                message=_"And how much did I spend?"
            [/message]
            [message]
                speaker=merchant
                message=_"$spartan_orbshop_data2.orbs_spent| orbs in your case."
            [/message]
            #endif

            [if]
            [have_unit]
                id=Algadur
            [/have_unit]
            [then]
            [message]
                speaker=Algadur
                message=_"I must admit, I'm... confused about tis' whole thing."
            [/message]
            [message]
                id=Hoplite,Hoplite2
                message=_"Can't say I fully understand what is happening either, but it seems I already met this 'merchant' before, in a past life of sorts."
            [/message]
            [/then]
            [/if]

            #scrapped merchant line, maybe might reuse later:

            message=_"It's hard to explain to most mortals, but let's just say we both did, and we did not..."



Previous notes (some still relevant, like tutorial):

spartan reworked story concept (could add the intro as part of the tutorial maybe):

story plan A:
-campaign mainly takes place in pre-fall Irdya
 -the main character is from a different world, one resembling mythological ancient greece, living in Sparta specifically
  -main character worships greek gods, probably Ares and Athena (this should be reflected in his lines regarding religion)
 prologue:
 -an archeological expedition led by Archmage Arcanus (the archmage boss) descend deep into the cave where the story takes place
  -it's an ominous ancient ruin, with altars and an unactivated portal, with a glowing crystal next to it
  -the expedition has several mages, including an old mage which will be 
  -archmage: "Finally, after decades of searching, we have finally found them - the Umbral Gates! According to the ancient writings we translated, the Gates can open a portal to other worlds. Begin the preparation for the ritual."
  -*fade to black, 1000ms delay, fade in*
  -random lower-level mage: "The preparation is complete, Master Arcanus."
  -archmage: "Yes, my apprentice, finally, we will finally be access other worlds! The possibilities are endless! Now time to activate the crystal..."
  -*archmage plays casting animation, screen flashes and some magic sounds are played*
  -*red portal opens*
  -random mage: "It's working!"
  *<insert final boss name here> (final boss demon of the campaign) enters the world from the portal, not sure about sprite yet*
  -<insert final boss name here>: "Yes, yes, the barrier between the worlds is finally broken! Irdya shall soon belong to me! Kneel before your future sovereign - <insert final boss name here>, Overlord of the Ninth Circle of Inferno!"
  -one of the random higher-level mages: "Dear god... we opened a portal the Inferno! Your experiment doomed us all, Arcanus!"
  -archmage: "Damn it! We have no time to waste. Quick, redirect the Gates to a different world!"
  -*portal changes color from red to blue*
  -*hoplite(s) enter(s) world from the portal*
  -sp: hoplite: "By Ares! Where... am I? What is happening?"
  -mp: hoplite: "By Ares! Where... are we? What is happening?"
  -<insert final boss name here>: "You are merely delaying the inevitable, foolish mortals!"
  -*<insert final boss name here> instakills some random mages*
  -archmage: "(to the hoplite) We can't stay here, quick, we must teleport outside the cave!"
  -*archmage plays casting animation*


  after everyone except archmage Arcanus and <insert final boss name here> have either fled or are dead:
  -<insert final boss name here>: "The others were worthless to me, but you Arcanus, you will make quite a useful puppet."
  -archmage: "No, no, what are you..."
  -<insert final boss name here>: "OBEY ME MORTAL!!!"#TODO: maybe add some kind of translated spell using Dugi's blackspeech generator
  -*magic sounds/maybe a flash, ominous music change*
  -*500ms delay*
  -<insert final boss name here>: "Now, be a good dog and reopen the portal to Inferno."
  -archmage: "Yes... my... master..."
  -*portal changes color to red, some demon warriors appear from it*
  -<insert final boss name here>: "Once enough of my armies arrive here, my glorious conquest shall begin!"




tutorial section:
 *fade to black, 3000 ms delay, fade in to a new map, somewhere in the grassland/hills/mountains near the cave*
 -mentor: "I see you're finally awake"
 -sp: hoplite: "Argh... where... am I? What happened?"
 -mp: hoplite: "Argh... where... are we? What happened?"
 -mentor: "You are now in Irdya, a world different from yours. You got accidentally teleported here"
 -sp: hoplite: "But why have you chosen me, an outsider to your world?"
 -mp: hoplite2: "But why have you chosen us, outsiders to your world?"
 -mentor: "<demon boss name> has sealed the cave entrance with powerful demonic magic - as long as he is alive, no creature from Irdya may enter or exit it, but demons and other otherwordly beings may freely pass through..."
 -hoplite: "I see."


 -mentor: "Before I can send you to stop the demons, I must first see how well-prepared you are for the task."
 -*teleports self and hoplite(s) to some kind of empty training ground*
 -note: during tutorial sections, the depth exit is usually locked until the objective is completed
 sp version of tutorial:
 tutorial 1:
 -*summons 3 quintains, they are 10hp units with shortrange 5-1 melee*
 -mentor: "Your first test is to destroy these three quintains."
 -*narrator message explaining some basic mechanics of the campaign, copied from info menu*
 after quintains are all killed:
 -hoplite: "That was easy. Hardly anything compared to the training we had back home."
 -mentor: "I assure you, this is just a warmup."
 tutorial 2:
 *map changes to have 1-tile wide, and an open depth exit*
 -mentor: "The next test will be a test of your athleticism - you must jump over the water."
 -narrator: "You can leap via a rightclick menu on your character. Leaping costs 50 energy, shown in the top-right corner. The main way to restore energy is by killing enemies. Energy is also fully restored when you go to the next level."
  if you run out of energy while not having reached the other side (repeated)
   -mentor: "Exhausting yourself by jumping all over the place won't do you any good. I'll restore your energy with magic this time, but you won't have that luxury in the caves..."
   -*restores energy*
  if you reach the other side of the stream:
   -mentor: "That was quite an impressive leap."
 tutorial 3:
  -*map has two quintains surrounded by water tiles*
  -mentor: "Sometimes an enemy will be just barely out of reach. Do you happen to be skilled with any ranged weapons?"
  -hoplite: "I prefer melee combat, but if necessary I can throw a spear quite far."
  -mentor: "Very well, demonstrate your spear-throwing skills on these quintains"
  -narrator: "To throw your spear, rightclick on a tile in a 2-tile radius from the hoplite. The spear can't be thrown again until it is picked up my moving to it."
  after killing one quintain:
   -mentor: "Good throw! Now leap to retreive the spear you've thrown"
  after killing the second quintain:
   -*hoplite moves to exit without touching the spear*
   -mentor: "Wait, you forgot your spear!"
   -hoplite: "Do not worry, my spear carries the blessing of Hermes. If I am too far from it, it eventually finds it way to me. Watch and observe."
  if you run out of energy (repeated)
   -mentor: "Exhausting yourself by jumping all over the place won't do you any good. I'll restore your energy with magic this time, but you won't have that luxury in the caves..."
   -*restores energy*
 tutorial 4:
  -mentor: "Amazing, it did return! Your world is quite interesting, I must admit. But back to the test..."
  -*summons three orc archers with the same image mods as shadow clone*
  -mentor: "Your next task is to kill three shadow clone archers. While they may be illusions, the arrows they shoot are just as dangerous as the real thing. Make sure to move out of the way once you see them aiming"
  -narrator: "tiles where archers are aiming will be highlighted in yellow. Archers will shoot on their turn"
  once the archers are killed:
  -mentor: "Well done, let's proceed"
 tutorial 5:
 -*summons some kind of powerful lvl2-3 unit which can be knocked back but has 30-50 hp and 10-15 damage*
 -*map has lava*
 -mentor: "Sometimes, it's best not to face an enemy head-on. Instead, you should use nearby terrain to your advantage - bash enemies into lava, walls, or chasms with your shield."
 -narrator: "You shield bash attack pushes enemies 1 tile, and slows them for a turn."
 when the enemy dies from lava/wallbash:
  -mentor: "As you can see, the environment can be just as deadly of a weapon as your spear."
 if the enemy dies from a normal attack:
  -mentor: "You actually managed to beat him head-on? I must admit, you surpassed even my expectations."
 tutorial 6:
  TODO: make this tutorial part about swapping/controlling rats
  (maybe rat in a hallway with side paths, and a ranged enemy at the end. if you don't control the rat, it gets kill and a new one is spawned at the start. if you control the rat and make it move ot the side, it can kill the ranged enemy)

 final tutorial:
  -mentor: "Forges allow you to choose from a wide variety of powerful upgrades."
  -*hoplite uses a forge*
  -*forge delay is set to -1 to ensure total numnber of upgrades stays same regardless of whether player starts at tutorial or depth 1*




 mp version of tutorial:
 TODO:

Changes in the actual campaign:
1.the prometheus heart is scrapped for now in this version. new objective: "kill <insert final boss name here> and return to your world"
2.shaxtal archmage fight is scrapped, the depth 15 fight is with the brainwashed archmage instead. he now has "Archmage Arcanus" as his name
3.upgrades tied to shaxtal archmage should be tied to something else instead


WIP:

idea for post-<insert final boss name here> depths (if I do decide to include steelhive units in the add-on):
elizabeth: "Though you could return now, I sense there is more going on in this cave than first seems... You could leave now, or you can follow me, and see how deep the rabbit hole goes..."

true final boss twist idea:
-mentor: "So, we meet again..."
-mentor: "Truth is, I only needed your help to get past the cave's barrier to continue my work on the Steelhive. With this forgotten technology, I shall be unstoppable! The world shall be mine!"
-*mentor enters some kind of powerful mech either from Steelhive or archaic era*


even better secret boss idea: the Mysterious Merchant could work a lot better as a true final boss
-maybe he has some ulterior motive for collecting lots of Orbs of Insight
-if the player runs into the merchant after beating him, he could say something like "Don't worry, I don't hold grudges."

older WIP story concept
-story takes place either late pre-fall or early post-fall (decide later whichever is better)
 -the main character is from a different world, one resembling mythological ancient greece (could use the custom ivory terrain from BMR/Trinity), living in Sparta specifically
  -main character worships greek gods, probably Ares and Athena (this should be reflected in his lines regarding religion)
-post-fall idea:
 -as the sun fell and wiped out Wesnoth, it also significantly weakened the barrier between worlds, creating several rifts between them. as a result of this
-pre-fall (not related to UtbS/IftU) idea:
 -in the Alduin academy, Archmage <come up with name later> (the archmage boss) attempts an ambitious experiment - a large magic crystal able to open portals to any other dimension
  -the experiment goes horribly wrong, with the crystal opening a portal directly to the Inferno
  -the academy is destroyed and most of the mages in it are killed by the demons, except the archmage who manages to flee with teleportation magic
-as a result of the barrier weakening, demons started entering the world through Inferno's rift, subjugating some orcs, nagas, necromancers and some others
 -the ancient greek world was also connected to Irdya by a rift, but this time a much less stable one
 idea a:
  -as the rift opens, a squad of demons emerges from it, stealing the Prometheus' Heart
 idea b:
  -the greeks see the crystal through the portal, believing it to be the Prometheus' Heart, a long-lost ancient artifact from their world
   -the hoplite(s) is sent to bring the crystal to Sparta

older concept 2:
-campaign mainly takes place in pre-fall Irdya
 -the main character is from a different world, one resembling mythological ancient greece (could use the custom ivory terrain from BMR/Trinity), living in Sparta specifically
  -main character worships greek gods, probably Ares and Athena (this should be reflected in his lines regarding religion)
 -in the Alduin academy, Archmage <come up with name later> (the archmage boss) attempts an ambitious experiment - a large magic crystal able to open portals to any other dimension
  -the experiment goes horribly wrong, with the crystal opening a portal directly to the Inferno, and a much smaller one to the greek world
  -the academy is destroyed and most of the mages in it are killed by the demons, except the archmage who manages to flee with teleportation magic
-as a result of the barrier weakening, demons started entering the world through Inferno's rift, subjugating some orcs, nagas, necromancers and some others
 -the ancient greek world was also connected to Irdya by a rift, but this time a much less stable one
-before the tutorial, a small prologue scenario takes place in the greek world (or maybe the alduin academy where the crystal experiment takes place)
-dialog idea for prologue:
 -*fade in to several mages around the crystal*
 -random lower-level mage: "The preparation is complete, Master."
 -archmage: "Yes, my apprentice, finally, after decades years of research, we will finally be access other worlds! The possibilities are endless! Now time to activate the crystal..."
 -*archmage plays casting animation, screen flashes and some magic sounds are played*
 -*two different portals open next to the crystal, one blue (to greek world) and one red (to Inferno)*
 -random mage: "It's working!"
 *a demon (a named boss one, perhaps even the final boss) enters the world from one of the portal*
 -demon: "Yes, yes, the barrier between the worlds is finally broken! Irdya shall be mine!"
 -one of the random mages: "Dear god... we opened a portal the Inferno! Your experiment doomed us all, <archmage name>!"
 -archmage: "We have no time to waste. Quick, redirect the crystal to a different world!"
