#textdomain wesnoth-Hoplite

#define HOPLITE_GUIDE_MENU
    [option]
        image="icons/book.png"
        description=_"Basic Rules"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Basic Rules"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"-You only have 1 movement point (like most enemies in the add-on)
-all units (both the player and the enemies) have <span color='#ffff99'>0% defense</span> everywhere, and units are unable to retaliate unless they have the <span color='#ffff99'>counterattack</span> weapon special
-your <span color='#ffff99'>turn ends</span> automatically when you <span color='#ffff99'>attack</span>, or <span color='#ffff99'>move</span> to a tile that doesn't have enemies next to it (unless you have the <span color='#ffff99'>Footwork</span> upgrade).
-In order to progress, move to the hex 6,2 (marked by a <span color='#ffff99'>trapdoor</span>). You will then move to the next depth.
-there is <span color='#ffff99'>no rest healing</span> (unless you have the <span color='#ffff99'>Rest II</span> upgrade), but you recover a third of your max hitpoints worth of health upon descending a depth
-the depths are semi-randomized, with a random map/enemy list. However, depth 1 is always a cave map with orc grunts.
-enemies have <span color='#ffff99'>long-ranged/short-ranged</span> attacks (explained more in the <span color='#ffff99'>Combat</span> section of the guide)
-each depth, there are upgrade <span color='#ffff99'>forges</span> on the map. (explained more in the <span color='#ffff99'>Forges/Upgrades</span> section of the guide). However they become rarer in the later depths
-depths are generated while you move onto the exit, and not in advance, meaning that it's possible to save-scum to get a different map/enemy generation for a given depth (with boss depths being an exception)
-every now and then, you may encounter various objects on the map, like signposts, tombstones, etc. that display text when moved onto. Most of them don't affect gameplay, and exist solely to add lore."
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description=_"Combat"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Combat"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"-all units (both the player and the enemies) have <span color='#ffff99'>0% defense</span> everywhere, and units are unable to retaliate unless they have the <span color='#ffff99'>counterattack</span> weapon special
-While the shield bash does next to no damage, it can <span color='#ffff99'>knock back</span> enemies and <span color='#ffff99'>slow</span> them, effectively rending them immobile for a turn. You can also kill most enemies by knocking them into <span color='#ffff99'>lava</span> or <span color='#ffff99'>chasms</span>, and harm them by bashing into <span color='#ffff99'>walls</span>.
-certain enemies, like <span color='#ffff99'>archers</span>, are able to attack from afar in a line. They <span color='#ffff99'>aim</span> at the start of your turn, and their <span color='#ffff99'>targeted hexes</span> are highlighted yellow red or blue if there is a unit they can attack. On their turn, they will shoot if your or your allies are on the <span color='#ffff99'>targeted hexes</span>.
-On the other hand, enemies with the <span color='#ffff99'>short-ranged</span> weapon special (like orcish grunts) can only attack you if you've been next to them on the previous turn, making them relatively easy targets.
-enemies are unable to attack when <span color='#ffff99'>slowed</span>, but you still can.
 -being slowed while you have no enemies next to you ends your turn
-You have a <span color='#ffff99'>killstreak<span> stat shown in the top of the interface. Your killstreak increases by 1 each time you kill an enemy (ally kills don't count), but your killstreak resets if you don't kill an enemy or hit a boss on your turn.
-some enemies are able to <span color='#ffff99'>summon</span> other enemies at regular intervals (like demiliches).
-enemies have increased hitpoints in <span color='#ffff99'>multiplayer</span> (5 extra hitpoints for normal enemies, and a 66% hitpoint increase (as well as a 33% damage increase) for bosses)
-poison deals 4 damage per turn instead of 8"
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description=_"Energy/Leaping"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Energy/Leaping"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                # wmllint: local spelling unwalkable
                message=_"<span color='#ffff99'>Leap</span> is an ability that can be accessed via a <span color='#ffff99'>right-click menu</span> on the leader unit. It allows him to move 2 hexes (3 if you have the <span color='#ffff99'>Teleport II</span> upgrade) for a turn, as well as to <span color='#ffff99'>jump over enemies/unwalkable terrain</span>, but costs <span color='#ffff99'>50 energy</span>. You start with <span color='#ffff99'>full energy</span> each time you enter a depth (the default is 100, but can be increased by energy upgrades). You also gain energy when <span color='#ffff99'>killing</span> enemies, equal to the target's level times 10 (5 energy for lvl0 enemies.) by default. Units killed by allies also give energy, but only half as much as normal (in <span color='#ffff99'>multiplayer</span>, both players get it though). When hitting <span color='#ffff99'>bosses</span> you also gain energy equal to their level times 5. You gain an extra 50 maximum energy after retrieving the <span color='#ffff99'>Prometheus' Heart</span> artifact."
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description=_"Forges/Upgrades"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Forges/Upgrades"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"Every depth (every 2 depths if you're past depth 30, or every 3 depths past 50), there will be a <span color='#ffff99'>forge</span> randomly placed on the map. Moving onto one will allow you to choose from a list of <span color='#ffff99'>upgrades</span>. Some upgrades require other upgrades to be unlocked in order to be available (like <span color='#ffff99'>Improved Armor II</span> only appearing after you unlock the normal <span color='#ffff99'>Improved Armor</span> upgrade), and some require both unlocking a certain upgrade AND beating a certain boss in the current playthrough (like <span color='#ffff99'>Improved Armor III</span>, for example, which requires beating the <span color='#ffff99'>spider queen</span> AND getting <span color='#ffff99'>Improved Armor II</span>)"
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description=_"Spear Throwing"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Spear Throwing"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"To <span color='#ffff99'>throw</span> your <span color='#ffff99'>spear</span>, choose the <span color='#ffff99'>right-click</span> menu option on an enemy that is standing in a <span color='#ffff99'>2-hex</span> (larger with certain upgrades) radius from you. When thrown, the spear will deal 10 damage (or more with upgrades) to the target, and apply the 'slowed' effect if the target is not killed. The spear can be then <span color='#ffff99'>picked up</span> by moving to the hex you thrown it to (and is <span color='#ffff99'>picked up automatically</span> when moving to the next depth), but until then, you won't be able to use your melee spear attack, leaving you quite vulnerable. You can use upgrades like <span color='#ffff99'>Recall</span> and <span color='#ffff99'>Follow</span> to quickly regain your spear though."
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description= _"Flame Blast"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Flame Blast"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"<span color='#ffff99'>Flame Blast</span> is a ranged attack, available after either the <span color='#ffff99'>Spear Throw I</span> or <span color='#ffff99'>Bow</span> upgrades and beating the <span color='#ffff99'>archmage</span>, used alongside the rest of your arsenal. The flame blast is aimed similar to the bow: you must <span color='#ffff99'>right-click</span> on an <span color='#ffff99'>adjacent hex</span> to yourself and the flame blast will appear in that direction, harming all enemies in the way (the targeted hexes are highlighted in red). However unlike the bow, it is <span color='#ffff99'>instant</span>. The ability is then put on a <span color='#ffff99'>4-turn cooldown</span> (the cooldown becomes shorter after some upgrades)."
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description=_"Achievements"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Achievements"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"Over the course of a <span color='#ffff99'>playthrough</span>, you may earn <span color='#ffff99'>achievements</span>, like reaching a specific depths, killing a specific amount of enemies, etc. Their completion is announced by a popup message on the screen. The list of your achievements (as well as ones you're yet to complete) can be accessed via the <span color='#ffff99'>information menu</span>. Achievements <span color='#ffff99'>carry over</span> between playthroughs of the campaign. You can reveal <span color='#ffff99'>hints</span> for <span color='#ffff99'>hidden</span> achievements by using <span color='#a456ff'>Orbs of Insight</span>."#, and unlock upgrades (TODO)
            [/message]
        [/command]
    [/option]
    [option]
        image="icons/book.png"
        description=_"Allies"
        [command]
            [message]
                speaker=narrator
                caption=_ "Hoplite Guide: Allies"
                image=portraits/book.png
#ifdef MULTIPLAYER
                side_for=$side_number
#endif
                message=_"Certain upgrades, such as <span color='#ffff99'>Rat tamer</span> or <span color='#ffff99'>Shadow Clone</span> allow you to summon <span color='#ffff99'>AI-controlled allies</span> at the start of each depth or via a right-click menu respectively. Most allies <span color='#ffff99'>disappear</span> whenever you descend a depth. If they block your way, you can <span color='#ffff99'>swap</span> places with them via <span color='#ffff99'>right-click menu</span>, or <span color='#ffff99'>order</span> them where to go via a right-click menu on the unit and then the tile you want the ally to go to. These two options can also be used to move them out of archers' line of fire in advance, for example. Allies with the <span color='#ffff99'>loyal</span> trait <span color='#ffff99'>carry over</span> between depths, and recover <span color='#ffff99'>50%</span> of their hitpoints with each descent. On top of that, allies with the <span color='#ffff99'>companion</span> ability don't permanently die, instead fleeing and <span color='#ffff99'>returning</span> after a few depths. They also have dialog."
            [/message]
        [/command]
    [/option]
#enddef

#define HOPLITE_INFO_MENU
    [event]
        name=start
        id=spartan_infomenu_event
        {HOPLITE_RETREIVE_DISCOVERED_UPGRADES}
        [set_menu_item]
            id=hoplite_infomenu
            description=_"Information Menu"
            image=misc/info_menu.png
            #        [show_if]
            #	  [have_unit]
            #	     id=Hoplite
            #	     x,y=$x1,$y1
            #	  [/have_unit]
            #	  [and]
            #	    [variable]
            #	       name=hoplite_debug
            #	       equals=yes
            #	    [/variable]
            #	  [/and]
            #        [/show_if]
            [command]
                [message]
                    speaker=narrator
                    caption=_ "Hoplite Information menu"
                    message=_ "Select option:"
#ifdef MULTIPLAYER
                    side_for=$side_number
#endif
                    [option]
                        image="misc/red-x.png"
                        description=_"Return to the Game"
                        [command]
                        [/command]
                    [/option]
                    [option]
                        image="terrain/forge-working.png"
                        description=_ "Show the list of all upgrades you currently have."
                        [command]
                            {IF_VAR side_number equals 2 (
                                [then]
                                    {VARIABLE hoplite_showcurrentupgrades2 yes}
                                    {HOPLITE_CREATE_CURRENT_UPGRADES_DIALOG_OPTIONS 2}
                                [/then]
                                [else]
                                    {VARIABLE hoplite_showcurrentupgrades yes}
                                    {HOPLITE_CREATE_CURRENT_UPGRADES_DIALOG_OPTIONS 1}
                                [/else]
                            )}
                            [while]
                                [variable]
                                    name=hoplite_showcurrentupgrades
                                    equals=yes
                                [/variable]
                                [or]
                                    [variable]
                                        name=hoplite_showcurrentupgrades2
                                        equals=yes
                                    [/variable]
                                [/or]
                                [do]
                                    [message]
                                        speaker=narrator
                                        caption=_"Hoplite Upgrade List"
                                        message=""
#ifdef MULTIPLAYER
                                        side_for=$side_number
#endif
                                        [option]
                                            image="misc/red-x.png"
                                            description=_"Return to the Game"
                                            [command]
                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                                            [/command]
                                        [/option]
                                        [insert_tag]
                                            name=option
                                            variable=hoplite_currentupgrades_options
                                        [/insert_tag]
                                    [/message]
                                [/do]
                            [/while]
                            {CLEAR_VARIABLE hoplite_currentupgrades_options}
                        [/command]
                    [/option]
                    [option]
                        image="terrain/forge-working.png"
                        description=_ "Show the list of all upgrades your teammate currently has."
                        [show_if]
                            {VARIABLE_CONDITIONAL hoplite_multiplayer equals yes}
                        [/show_if]
                        [command]
                            {IF_VAR side_number equals 2 (
                                [then]
                                    {VARIABLE hoplite_showcurrentupgrades yes}
                                    {HOPLITE_CREATE_CURRENT_UPGRADES_DIALOG_OPTIONS 1}
                                [/then]
                                [else]
                                    {VARIABLE hoplite_showcurrentupgrades2 yes}
                                    {HOPLITE_CREATE_CURRENT_UPGRADES_DIALOG_OPTIONS 2}
                                [/else]
                            )}
                            [while]
                                [variable]
                                    name=hoplite_showcurrentupgrades
                                    equals=yes
                                [/variable]
                                [or]
                                    [variable]
                                        name=hoplite_showcurrentupgrades2
                                        equals=yes
                                    [/variable]
                                [/or]
                                [do]
                                    [message]
                                        speaker=narrator
                                        caption=_ "Hoplite Upgrade List (of your teammate)"
                                        message=""
#ifdef MULTIPLAYER
                                        side_for=$side_number
#endif
                                        [option]
                                            image="misc/red-x.png"
                                            description=_"Return to the Game"
                                            [command]
                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                                            [/command]
                                        [/option]
                                        [insert_tag]
                                            name=option
                                            variable=hoplite_currentupgrades_options
                                        [/insert_tag]
                                    [/message]
                                [/do]
                            [/while]
                            {CLEAR_VARIABLE hoplite_currentupgrades_options}
                        [/command]
                    [/option]
                    [option]
                        image="icons/book2.png"
                        description=_ "Active Pacts"
                        [show_if]
                            {VARIABLE_CONDITIONAL spartan_activepacts.length greater_than 0}
                        [/show_if]
                        [command]
                            {VARIABLE hoplite_pact_menu yes}
                            {SPARTAN_GENERATE_ACTIVE_PACT_OPTIONS}
                            [while]
                                [variable]
                                    name=hoplite_pact_menu
                                    equals=yes
                                [/variable]
                                [do]
                                    [message]
                                        speaker=narrator
                                        caption=_ "Active Pacts:"
                                        message=_ "Here are the currently active pacts. Select them to see the detailed description, and how many depths are left:"
                                        image="portraits/book.png~GS()~BLEND(0,0,0,0.4)"
                                        [option]
                                            image="misc/red-x.png"
                                            description=_"Return to the Game"
                                            [command]
                                                {CLEAR_VARIABLE hoplite_pact_menu}
                                            [/command]
                                        [/option]
                                        [insert_tag]
                                            name=option
                                            variable=spartan_activepact_options
                                        [/insert_tag]
                                    [/message]
                                [/do]
                            [/while]
                            {CLEAR_VARIABLE spartan_activepact_options}
                        [/command]
                    [/option]
                    [option]
                        image="icons/book.png"
                        description=_ "Hoplite Guide"
                        [command]
                            {VARIABLE hopliteguide_menu yes}
                            [while]
                                [variable]
                                    name=hopliteguide_menu
                                    equals=yes
                                [/variable]
                                [do]
                                    [message]
                                        speaker=narrator
                                        caption=_ "Hoplite Guide"
                                        message=_ "Choose topic:"
                                        image=portraits/book.png
#ifdef MULTIPLAYER
                                        side_for=$side_number
#endif
                                        [option]
                                            image="misc/red-x.png"
                                            description=_"Return to the Game"
                                            [command]
                                                {CLEAR_VARIABLE hopliteguide_menu}
                                            [/command]
                                        [/option]
                                        {HOPLITE_GUIDE_MENU}
                                    [/message]
                                [/do]
                            [/while]
                        [/command]
                    [/option]
                    #               [option]
                    #			image="icons/book2.png"
                    #			id="Enemy Catalog"
                    #			[command]
                    #			{VARIABLE hopliteenemycatalog_menu yes}
                    #                        [while]
                    #                         [variable]
                    #                            name=hopliteenemycatalog_menu
                    #                            equals=yes
                    #                         [/variable]
                    #                         [do]
                    #     			 [message]
                    #		           speaker=narrator
                    #	                   caption="Enemy catalog:"
                    #                           message="Choose entry to learn more about a specific enemy type (more entries appear as you encounter more types of foes):"
                    #			   image=portraits/book.png
                    ##ifdef MULTIPLAYER
                    #                           side_for=$side_number
                    ##endif
                    #                           [option]
                    #                  	    image="misc/red-x.png"
                    # 			    description=_"Return to the Game"
                    #			    [command]
                    #			      {CLEAR_VARIABLE hopliteenemycatalog_menu}
                    #                            [/command]
                    #                    	   [/option]
                    #			   {HOPLITE_ENEMYCATALOG_MENU}
                    #			 [/message]
                    #                         [/do]
                    #			[/while]
                    #	                [/command]
                    #	       [/option]
                    [option]
                        image="icons/book.png"
                        description=_ "Show the list of all upgrades, and which of them you already discovered

NOTE: not every upgrade is available via the forge, and some are only available for specific characters"
                        [command]
                            {IF_VAR side_number equals 2 (
                                [then]
                                    {VARIABLE hoplite_showcurrentupgrades2 yes}
                                    {VARIABLE hoplite_showdiscovered_upgrades yes}
                                    {HOPLITE_CREATE_DISCOVERED_UPGRADES_DIALOG_OPTIONS 2}
                                [/then]
                                [else]
                                    {VARIABLE hoplite_showcurrentupgrades yes}
                                    {VARIABLE hoplite_showdiscovered_upgrades yes}
                                    {HOPLITE_CREATE_DISCOVERED_UPGRADES_DIALOG_OPTIONS 1}
                                [/else]
                            )}
                            [while]
                                [variable]
                                    name=hoplite_showcurrentupgrades
                                    equals=yes
                                [/variable]
                                [or]
                                    [variable]
                                        name=hoplite_showcurrentupgrades2
                                        equals=yes
                                    [/variable]
                                [/or]
                                [do]
                                    [message]
                                        speaker=narrator
                                        caption=_ "Hoplite Discovered Upgrade List"
                                        image=portraits/book.png
                                        message=""
#ifdef MULTIPLAYER
                                        side_for=$side_number
#endif
                                        [option]
                                            image="misc/red-x.png"
                                            description=_"Return to the Game"
                                            [command]
                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                                                {CLEAR_VARIABLE hoplite_showdiscovered_upgrades}
                                            [/command]
                                        [/option]
                                        [insert_tag]
                                            name=option
                                            variable=hoplite_discoveredupgrades_options
                                        [/insert_tag]
                                        [option]
                                            image="icons/book.png~BLIT(icons/big_x.png)"
                                            description=_"Clear discovered upgrades."
#ifdef MULTIPLAYER
                                            side_for=$side_number
#endif
                                            [command]
                                                [message]
                                                    speaker=narrator
                                                    caption=_ "Discovered Upgrades"
                                                    image=portraits/book.png
                                                    message=_ "Are you really sure you want to <span color='#ff0000'>delete</span> your <span color='#ff0000'>discovered upgrades</span> progress? (This option can't be undone)"
                                                    image=misc/laurel.png~SCALE(216,216)
                                                    sound={SOUND_LIST:LICH_HIT}
#ifdef MULTIPLAYER
                                                    side_for=$side_number
#endif
                                                    [option]
                                                        image="attacks/blank-attack.png"
                                                        description=_"No, of course not. I clicked this by accident."
                                                        [command]
                                                            {CLEAR_VARIABLE hopliteachievement_menu}
                                                        [/command]
                                                    [/option]
                                                    [option]
                                                        image="attacks/wail.png"
                                                        description=_"<span color='#ff0000'>Yes, I know what I'm doing.</span>"
                                                        [command]
                                                            {FLASH_WHITE (
                                                                [sound]
                                                                    name=lightning.ogg
                                                                [/sound])}
                                                                [print]
                                                                    text= _ "Discovered upgrades reset!"
                                                                    size=25
                                                                    red=255
                                                                    duration=3000
                                                                [/print]
                                                                {HOPLITE_CLEAR_DISCOVEREDUPGRADES $side_number}
                                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                                                                {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                                                                {CLEAR_VARIABLE hoplite_showdiscovered_upgrades}
                                                            [/command]
                                                        [/option]
                                                    [/message]
                                                [/command]
                                            [/option]
                                        [/message]
                                    [/do]
                                [/while]
                                {CLEAR_VARIABLE hoplite_discoveredupgrades_options}
                            [/command]
                        [/option]
                        [option]
                            image="misc/laurel.png"
                            description=_ "Achievements"
                            [command]
                                {VARIABLE hopliteachievement_menu yes}
                                #only needed for local mp so that achievements don't desync between the two sides
#ifdef LOCALMP
                                {HOPLITE_ACHIEVEMENTLIST RETREIVE_ACHIEVEMENT}
#endif
                                {HOPLITE_CREATE_ACHIEVEMENT_DIALOG_OPTIONS}
                                [while]
                                    [variable]
                                        name=hopliteachievement_menu
                                        equals=yes
                                    [/variable]
                                    [do]
                                        [message]
                                            speaker=narrator
                                            caption=_ "Achievements:"
                                            message=_ "Here are the achievements that you either completed, or are yet to complete (completed achievements are labeled with golden laurels, while incomplete ones are labeled with bronze laurels or question marks)

You currently have <span color='#a456ff'>$spartan_orbs_of_insight$side_number|| Orbs of Insight</span> (carries over between playthroughs)"
                                            #        image=portraits/book.png
                                            image=misc/laurel.png~SCALE(216,216)
                                            [option]
                                                image="misc/red-x.png"
                                                description=_"Return to the Game"
                                                [command]
                                                    {CLEAR_VARIABLE hopliteachievement_menu}
                                                [/command]
                                            [/option]
                                            [insert_tag]
                                                name=option
                                                variable=hoplite_achievement_options
                                            [/insert_tag]
                                            [option]
                                                image="misc/laurel.png~SCALE(60,60)~BLIT(icons/big_x.png)"
                                                description=_"Wipe your achievement progress
          (all achievements you completed, orbs of insight and hints.)"
                                                [command]
                                                    [message]
                                                        speaker=narrator
                                                        caption=_ "Achievements:"
                                                        message=_ "Are you really sure you want <span color='#ff0000'>delete</span> your <span color='#ff0000'>achievements, orbs of insight and achievement hints</span>? (This option cannot be undone)"
                                                        image=misc/laurel.png~SCALE(216,216)
                                                        sound={SOUND_LIST:LICH_HIT}
#ifdef MULTIPLAYER
                                                        side_for=$side_number
#endif
                                                        [option]
                                                            image="attacks/blank-attack.png"
                                                            description=_"No, of course not. I clicked this by accident."
                                                            [command]
                                                                {CLEAR_VARIABLE hopliteachievement_menu}
                                                            [/command]
                                                        [/option]
                                                        [option]
                                                            image="attacks/wail.png"
                                                            description=_"<span color='#ff0000'>Yes, I know what I'm doing.</span>"
                                                            [command]
                                                                {FLASH_WHITE (
                                                                    [sound]
                                                                        name=lightning.ogg
                                                                    [/sound])}
                                                                    [print]
                                                                        text= _ "Achievements reset!"
                                                                        size=25
                                                                        red=255
                                                                        duration=3000
                                                                    [/print]
                                                                    {HOPLITE_ACHIEVEMENTLIST CLEAR_ACHIEVEMENT}
                                                                    [clear_global_variable]
                                                                        namespace=spartan
                                                                        global=orbs_of_insight
                                                                        side=$side_number
                                                                        immediate=yes
                                                                    [/clear_global_variable]
                                                                    [clear_global_variable]
                                                                        namespace=spartan
                                                                        global=achievementhints_array
                                                                        side=$side_number
                                                                        immediate=yes
                                                                    [/clear_global_variable]
                                                                    #merchant global variables are cleared too
                                                                    {CLEAR_VARIABLE spartan_orbshop_data$side_number}
                                                                    [clear_global_variable]
                                                                        namespace=spartan
                                                                        global=spartan_orbshop_data
                                                                        side=$side_number
                                                                        immediate=yes
                                                                    [/clear_global_variable]
                                                                    {HOPLITE_ACHIEVEMENTLIST RETREIVE_ACHIEVEMENT}
                                                                    {HOPLITE_GET_ORBS_OF_INSIGHT}
                                                                    {HOPLITE_RETREIVE_ACHIEVEMENT_HINTS}
                                                                    {CLEAR_VARIABLE hopliteachievement_menu}
                                                                [/command]
                                                            [/option]
                                                        [/message]
                                                    [/command]
                                                [/option]
                                                [option]
                                                    image="scenery/trapdoor-open.png~BLIT(icons/big_x.png)"
                                                    description=_"Clear the starting depth options."
#ifdef MULTIPLAYER
                                                    side_for=$side_number
#endif
                                                    [command]
                                                        [message]
                                                            speaker=narrator
                                                            caption=_ "Achievements:"
                                                            message=_ "Are you really sure you want to <span color='#ff0000'>delete</span> your <span color='#ff0000'>starting depth</span> progress so far? (This option can't be undone)"
                                                            image=misc/laurel.png~SCALE(216,216)
                                                            sound={SOUND_LIST:LICH_HIT}
#ifdef MULTIPLAYER
                                                            side_for=$side_number
#endif
                                                            [option]
                                                                image="attacks/blank-attack.png"
                                                                description=_"No, of course not. I clicked this by accident."
                                                                [command]
                                                                    {CLEAR_VARIABLE hopliteachievement_menu}
                                                                [/command]
                                                            [/option]
                                                            [option]
                                                                image="attacks/wail.png"
                                                                description=_"<span color='#ff0000'>Yes, I know what I'm doing.</span>"
                                                                [command]
                                                                    {FLASH_WHITE (
                                                                        [sound]
                                                                            name=lightning.ogg
                                                                        [/sound])}
                                                                        [print]
                                                                            text= _ "Starting depths reset!"
                                                                            size=25
                                                                            red=255
                                                                            duration=3000
                                                                        [/print]
                                                                        [clear_global_variable]
                                                                            namespace=spartan
                                                                            global=depth11_unlocked
                                                                            side=$side_number
                                                                            immediate=yes
                                                                        [/clear_global_variable]
                                                                        [clear_global_variable]
                                                                            namespace=spartan
                                                                            global=depth21_unlocked
                                                                            side=$side_number
                                                                            immediate=yes
                                                                        [/clear_global_variable]
                                                                        [clear_global_variable]
                                                                            namespace=spartan
                                                                            global=depth31_unlocked
                                                                            side=$side_number
                                                                            immediate=yes
                                                                        [/clear_global_variable]
                                                                        [clear_global_variable]
                                                                            namespace=spartan
                                                                            global=depth41_unlocked
                                                                            side=$side_number
                                                                            immediate=yes
                                                                        [/clear_global_variable]
                                                                        [clear_global_variable]
                                                                            namespace=spartan
                                                                            global=depth0_unlocked
                                                                            side=$side_number
                                                                            immediate=yes
                                                                        [/clear_global_variable]
                                                                        [clear_global_variable]
                                                                            namespace=spartan
                                                                            global=depth99_unlocked
                                                                            side=$side_number
                                                                            immediate=yes
                                                                        [/clear_global_variable]
                                                                        {CLEAR_VARIABLE hopliteachievement_menu}
                                                                    [/command]
                                                                [/option]
                                                            [/message]
                                                        [/command]
                                                    [/option]
                                                [/message]
                                            [/do]
                                        [/while]
                                        {CLEAR_VARIABLE hoplite_achievement_options}
                                    [/command]
                                [/option]
                            [/message]
                        [/command]
                    [/set_menu_item]
#ifdef MULTIPLAYER
                    #for now just shows upgrades/pacts, might add more stuff later, not sure yet
                    [set_menu_item]
                        id=spartan_observer_menu
                        description=_"Observer Menu"
                        image=misc/info_menu.png
                        synced=no
                        [show_if]
                            [spartan_is_observer]
                            [/spartan_is_observer]
                        [/show_if]
                        [command]
                            [message]
                                speaker=narrator
                                caption=_ "Hoplite Observer menu"
                                message=_ "Select option:"
                                [option]
                                    image="misc/red-x.png"
                                    description=_"Return to the Game"
                                    [command]
                                    [/command]
                                [/option]
                                [option]
                                    image="terrain/forge-working.png"
                                    description=_ "Show the list of all upgrades Player 1 currently has"
                                    [command]
                                        {HOPLITE_CREATE_CURRENT_UPGRADES_DIALOG_OPTIONS 1}
                                        {VARIABLE hoplite_showcurrentupgrades yes}
                                        [while]
                                            [variable]
                                                name=hoplite_showcurrentupgrades
                                                equals=yes
                                            [/variable]
                                            [or]
                                                [variable]
                                                    name=hoplite_showcurrentupgrades2
                                                    equals=yes
                                                [/variable]
                                            [/or]
                                            [do]
                                                [message]
                                                    speaker=narrator
                                                    caption=_ "Hoplite Upgrade List"
                                                    message=""
#ifdef MULTIPLAYER
                                                    side_for=$side_number
#endif
                                                    [option]
                                                        image="misc/red-x.png"
                                                        description=_"Return to the Game"
                                                        [command]
                                                            {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                                                            {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                                                        [/command]
                                                    [/option]
                                                    [insert_tag]
                                                        name=option
                                                        variable=hoplite_currentupgrades_options
                                                    [/insert_tag]
                                                [/message]
                                            [/do]
                                        [/while]
                                        {CLEAR_VARIABLE hoplite_currentupgrades_options}
                                    [/command]
                                [/option]
                                [option]
                                    image="terrain/forge-working.png"
                                    description=_ "Show the list of all upgrades Player 2 currently has."
                                    [show_if]
                                        {VARIABLE_CONDITIONAL hoplite_multiplayer equals yes}
                                    [/show_if]
                                    [command]
                                        {HOPLITE_CREATE_CURRENT_UPGRADES_DIALOG_OPTIONS 2}
                                        {VARIABLE hoplite_showcurrentupgrades2 yes}
                                        [while]
                                            [variable]
                                                name=hoplite_showcurrentupgrades
                                                equals=yes
                                            [/variable]
                                            [or]
                                                [variable]
                                                    name=hoplite_showcurrentupgrades2
                                                    equals=yes
                                                [/variable]
                                            [/or]
                                            [do]
                                                [message]
                                                    speaker=narrator
                                                    caption=_ "Hoplite Upgrade List"
                                                    message=""
#ifdef MULTIPLAYER
                                                    side_for=$side_number
#endif
                                                    [option]
                                                        image="misc/red-x.png"
                                                        description=_"Return to the Game"
                                                        [command]
                                                            {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                                                            {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                                                        [/command]
                                                    [/option]
                                                    [insert_tag]
                                                        name=option
                                                        variable=hoplite_currentupgrades_options
                                                    [/insert_tag]
                                                [/message]
                                            [/do]
                                        [/while]
                                        {CLEAR_VARIABLE hoplite_currentupgrades_options}
                                    [/command]
                                [/option]
                                [option]
                                    image="icons/book2.png"
                                    description=_ "Active Pacts"
                                    [show_if]
                                        {VARIABLE_CONDITIONAL spartan_activepacts.length greater_than 0}
                                    [/show_if]
                                    [command]
                                        {VARIABLE hoplite_pact_menu yes}
                                        {SPARTAN_GENERATE_ACTIVE_PACT_OPTIONS}
                                        [while]
                                            [variable]
                                                name=hoplite_pact_menu
                                                equals=yes
                                            [/variable]
                                            [do]
                                                [message]
                                                    speaker=narrator
                                                    caption=_ "Active Pacts:"
                                                    message=_ "Here are the currently active pacts. Select them to see the detailed description, and how many depths are left:"
                                                    image="portraits/book.png~GS()~BLEND(0,0,0,0.4)"
                                                    [option]
                                                        image="misc/red-x.png"
                                                        description=_"Return to the Game"
                                                        [command]
                                                            {CLEAR_VARIABLE hoplite_pact_menu}
                                                        [/command]
                                                    [/option]
                                                    [insert_tag]
                                                        name=option
                                                        variable=spartan_activepact_options
                                                    [/insert_tag]
                                                [/message]
                                            [/do]
                                        [/while]
                                        {CLEAR_VARIABLE spartan_activepact_options}
                                    [/command]
                                [/option]
                            [/message]
                        [/command]
                    [/set_menu_item]
#endif
                [/event]
                [event]
                    name=preload
                    id=spartan_lua_observer_custom_tag
                    first_time_only=no
                    [lua]
                        code=<<
function wesnoth.wml_conditionals.spartan_is_observer()
    local all_sides = wesnoth.sides.find()
    for index, side in ipairs(all_sides) do
        if side.controller == "human" and side.is_local then
            return false
        end
    end
    return true
end
    >>
                    [/lua]
                [/event]
#enddef
