#textdomain wesnoth-Hoplite

#define HOPLITE_GUIDE_MENU
[option]
        image="icons/book.png"
	description=_"Basic Rules"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Basic Rules"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"-You only have 1 movement point (like most enemies in the add-on)
-all units (both the player and the enemies) have <span color='#7575ff'>0% defense</span> everywhere, and units are unable to retaliate unless they have the <span color='#7575ff'>counterattack</span> weapon special
-your <span color='#7575ff'>turn ends</span> automatically when you <span color='#7575ff'>attack</span>, or <span color='#7575ff'>move</span> to a tile that doesn't have enemies next to it (unless you have the <span color='#7575ff'>Footwork</span> upgrade).
-In order to progress, move to the hex 6,2 (marked by a <span color='#7575ff'>trapdoor</span>). You will then move to the next depth.
-there is <span color='#7575ff'>no rest healing</span> (unless you have the <span color='#7575ff'>Rest II</span> upgrade), but you recover a third of your max hitpoints worth of health upon descending a depth
-the depths are semi-randomized, with a random map/enemy list. However, depth 1 is always a cave map with orc grunts.
-enemies have <span color='#7575ff'>long-ranged/short-ranged</span> attacks (explained more in the <span color='#7575ff'>Combat</span> section of the guide)
-each depth, there are upgrade <span color='#7575ff'>forges</span> on the map. (explained more in the <span color='#7575ff'>Forges/Upgrades</span> section of the guide). However they become rarer in the later depths
-depths are generated while you move onto the exit, and not in advance, meaning that it's possible to save-scum to get a different map/enemy generation for a given depth (with boss depths being an exception)
-every now and then, you may encounter various objects on the map, like signposts, tombstones, etc. that display text when moved onto. Most of them don't affect gameplay, and exist solely to add lore."
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description=_"Combat"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Combat"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"-all units (both the player and the enemies) have <span color='#7575ff'>0% defense</span> everywhere, and units are unable to retaliate unless they have the <span color='#7575ff'>counterattack</span> weapon special
-While the shield bash does next to no damage, it can <span color='#7575ff'>knock back</span> enemies and <span color='#7575ff'>slow</span> them, effectively rending them immobile for a turn. You can also kill most enemies by knocking them into <span color='#7575ff'>lava</span> or <span color='#7575ff'>chasms</span>, and harm them by bashing into <span color='#7575ff'>walls</span>.
-certain enemies, like <span color='#7575ff'>archers</span>, are able to attack from afar in a line. They <span color='#7575ff'>aim</span> at the start of your turn, and their <span color='#7575ff'>targeted hexes</span> are highlighted yellow red or blue if there is a unit they can attack. On their turn, they will shoot if your or your allies are on the <span color='#7575ff'>targeted hexes</span>.
-On the other hand, enemies with the <span color='#7575ff'>short-ranged</span> weapon special (like orcish grunts) can only attack you if you've been next to them on the previous turn, making them relatively easy targets.
-enemies are unable to attack when <span color='#7575ff'>slowed</span>, but you still can.
 -being slowed while you have no enemies next to you ends your turn
-some enemies are able to <span color='#7575ff'>summon</span> other enemies at regular intervals (like demiliches).
-enemies have increased hitpoints in <span color='#7575ff'>multiplayer</span> (5 extra hitpoints for normal enemies, and a 66% hitpoint increase (as well as a 33% damage increase) for bosses)"
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description=_"Energy/Leaping"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Energy/Leaping"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"<span color='#7575ff'>Leap</span> is an ability that can be accessed via a <span color='#7575ff'>rightclick menu</span> on the leader unit. It allows him to move 2 hexes (3 if you have the <span color='#7575ff'>Teleport II</span> upgrade) for a turn, as well as to <span color='#7575ff'>jump over enemies/unwalkable terrain</span>, but costs <span color='#7575ff'>50 energy</span>. You start with <span color='#7575ff'>full energy</span> each time you enter a depth (the default is 100, but can be increased by energy upgrades). You also gain energy when <span color='#7575ff'>killing</span> enemies, equal to the target's level times 10 (5 energy for lvl0 enemies.) by default. Units killed by allies also give energy, but only half as much as normal (in <span color='#7575ff'>multiplayer</span>, both players get it though). When hitting <span color='#7575ff'>bosses</span> you also gain energy equal to their level times 5. You gain an extra 50 maximum energy after retrieving the <span color='#7575ff'>Prometheus' Heart</span> artifact."
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description=_"Forges/Upgrades"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Forges/Upgrades"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"Every depth (every 2 depths if you're past depth 30, or every 3 depths past 50), there will be a <span color='#7575ff'>forge</span> randomly placed on the map. Moving onto one will allow you to choose from a list of <span color='#7575ff'>upgrades</span>. Some upgrades require other upgrades to be unlocked in order to be available (like <span color='#7575ff'>Improved Armor II</span> only appearing after you unlock the normal <span color='#7575ff'>Improved Armor</span> upgrade), and some require both unlocking a certain upgrade AND beating a certain boss in the current playthrouh (like <span color='#7575ff'>Improved Armor III</span>, for example, which requires beating the <span color='#7575ff'>spider queen</span> AND getting <span color='#7575ff'>Improved Armor II</span>)"
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description=_"Spear Throwing"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Spear Throwing"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"To <span color='#7575ff'>throw</span> your <span color='#7575ff'>spear</span>, choose the <span color='#7575ff'>rightclick</span> menu option on an enemy that is standing in a <span color='#7575ff'>2-hex</span> (larger with certain upgrades) radius from you. When thrown, the spear will deal 10 damage (or more with upgrades) to the target, and apply the 'slowed' effect if the target is not killed. The spear can be then <span color='#7575ff'>picked up</span> by moving to the hex you thrown it to (and is <span color='#7575ff'>picked up automatically</span> when moving to the next depth), but until then, you won't be able to use your melee spear attack, leaving you quite vulnerable. You can use upgrades like <span color='#7575ff'>Recall</span> and <span color='#7575ff'>Follow</span> to quickly regain your spear though."
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description= _"Flame Blast"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Flame Blast"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"<span color='#7575ff'>Flame Blast</span> is a ranged attack, available after either the <span color='#7575ff'>Spear Throw I</span> or <span color='#7575ff'>Bow</span> upgrades and beating the <span color='#7575ff'>archmage</span>, used alongside the rest of your arsenal. The flame blast is aimed similar to the bow: you must <span color='#7575ff'>rightclick</span> on an <span color='#7575ff'>adjacent hex</span> to yourself and the flame blast will appear in that direction, harming all enemies in the way (the targeted hexes are highlighted in red). However unlike the bow, it is <span color='#7575ff'>instant</span>. The ability is then put on a <span color='#7575ff'>4-turn cooldown</span> (the cooldown becomes shorter after some upgrades)."
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description=_"Achievements"
	[command]
  		 [message]
	           speaker=narrator
                   caption="Hoplite Guide: Achievements"
		   image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"Over the course of a <span color='#7575ff'>playthrough</span>, you may earn <span color='#7575ff'>achievements</span>, like reaching a specific depths, killing a specific amount of enemies, etc. Their completion is announced by a popup message on the screen. The list of your achievements (as well as ones you're yet to complete) can be accessed via the <span color='#7575ff'>information menu</span>. Achievements <span color='#7575ff'>carry over</span> between playthroughs of the campaign. You can reveal <span color='#7575ff'>hints</span> for <span color='#7575ff'>hidden</span> achievements by using <span color='#a456ff'>Orbs of Insight</span>."#, and unlock upgrades (TODO)
		 [/message]
        [/command]
[/option]
[option]
        image="icons/book.png"
	description=_"Allies"
	[command]
  		[message]
	        speaker=narrator
            caption="Hoplite Guide: Allies"
		    image=portraits/book.png
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                   message=_"Certain upgrades, such as <span color='#7575ff'>Rat tamer</span> or <span color='#7575ff'>Shadow Clone</span> allow you to summon <span color='#7575ff'>AI-controlled allies</span> at the start of each depth or via a rightclick menu respectively. Most allies <span color='#7575ff'>disappear</span> whenever you descend a depth. If they block your way, you can <span color='#7575ff'>swap</span> places with them via <span color='#7575ff'>rightclick menu</span>, or <span color='#7575ff'>order</span> them where to go via a rightclick menu on the unit and then the tile you want the ally to go to. These two options can also be used to move them out of archers' line of fire in advance, for example. Allies with the <span color='#7575ff'>loyal</span> trait <span color='#7575ff'>carry over</span> between depths, and recover <span color='#7575ff'>50%</span> of their htipoints with each descent. On top of that, allies with the <span color='#7575ff'>companion</span> ability don't permanently die, instead fleeing and <span color='#7575ff'>returning</span> after a few depths. They also have dialog."
		 [/message]
        [/command]
[/option]
#enddef

#define HOPLITE_INFO_MENU
    [event]
       name=start
       id=spartan_infomenu_event
       {HOPLITE_RETREIVE_DISCOVERED_UPGRADES}
    [set_menu_item]
        id=hoplite_infomenu
        description=_"Information Menu"
        image=items/book2.png~CROP(21,23,27,24)~SCALE(20,20)
#        [show_if]
#	  [have_unit]
#	     id=Hoplite
#	     x,y=$x1,$y1
#	  [/have_unit]
#	  [and]
#	    [variable]
#	       name=hoplite_debug
#	       equals=yes
#	    [/variable]
#	  [/and]
#        [/show_if]
        [command]
	[message]
		speaker=narrator
		caption="Hoplite Information menu"
                message="Select option:"
#ifdef MULTIPLAYER
                   side_for=$side_number
#endif
                [option]
                  	image="misc/red-x.png"
			description=_"Return to the Game"
			[command]
                        [/command]
		[/option]
                [option]
                        image="terrain/forge-working.png"
			description="Show the list of all upgrades you currently have."
			[command]
            {IF_VAR side_number equals 2 (
            [then]
                {VARIABLE hoplite_showcurrentupgrades2 yes}
            [/then]
            [else]
                {VARIABLE hoplite_showcurrentupgrades yes}
            [/else]
            )}
                        [while]
                         [variable]
                            name=hoplite_showcurrentupgrades
                            equals=yes
                         [/variable]
                         [or]
                         [variable]
                            name=hoplite_showcurrentupgrades2
                            equals=yes
                         [/variable]
                         [/or]
                         [do]
     			 [message]
		           speaker=narrator
	                   caption="Hoplite Upgrade List"
                           message=""
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
                           [option]
                  	    image="misc/red-x.png"
 			    description=_"Return to the Game"
			    [command]
			      {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                            [/command]
                    	   [/option]
                    	   {FORGE_UPGRADE_LIST}
                         [/message]
			 [/do]
			[/while]
	                [/command]
	       [/option]
               [option]
                        image="terrain/forge-working.png"
			description="Show the list of all upgrades your teammate currently has."
			[show_if]
			  {VARIABLE_CONDITIONAL hoplite_multiplayer equals yes}
			[/show_if]
			[command]
            {IF_VAR side_number equals 2 (
            [then]
                {VARIABLE hoplite_showcurrentupgrades yes}
            [/then]
            [else]
                {VARIABLE hoplite_showcurrentupgrades2 yes}
            [/else]
            )}
                        [while]
                         [variable]
                            name=hoplite_showcurrentupgrades
                            equals=yes
                         [/variable]
                         [or]
                         [variable]
                            name=hoplite_showcurrentupgrades2
                            equals=yes
                         [/variable]
                         [/or]
                         [do]
     			 [message]
		           speaker=narrator
	                   caption="Hoplite Upgrade List (of your teammate)"
                           message=""
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
                           [option]
                  	    image="misc/red-x.png"
 			    description=_"Return to the Game"
			    [command]
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades}
			      {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                            [/command]
                    	   [/option]
                    	   {FORGE_UPGRADE_LIST}
                         [/message]
			 [/do]
			[/while]
	                [/command]
	       [/option]
               [option]                        
			image="icons/book.png"
			description="Hoplite Guide"
			[command]
			{VARIABLE hopliteguide_menu yes}
                        [while]
                         [variable]
                            name=hopliteguide_menu
                            equals=yes
                         [/variable]
                         [do]
     			 [message]
		           speaker=narrator
	                   caption="Hoplite Guide"
                           message="Choose topic:"
			   image=portraits/book.png
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
                           [option]
                  	    image="misc/red-x.png"
 			    description=_"Return to the Game"
			    [command]
			      {CLEAR_VARIABLE hopliteguide_menu}
                            [/command]
                    	   [/option]
			   {HOPLITE_GUIDE_MENU}
			 [/message]
                         [/do]
			[/while]
	                [/command]
	       [/option]
#               [option]                        
#			image="icons/book2.png"
#			description="Enemy Catalog"
#			[command]
#			{VARIABLE hopliteenemycatalog_menu yes}
#                        [while]
#                         [variable]
#                            name=hopliteenemycatalog_menu
#                            equals=yes
#                         [/variable]
#                         [do]
#     			 [message]
#		           speaker=narrator
#	                   caption="Enemy catalog:"
#                           message="Choose entry to learn more about a specific enemy type (more entries appear as you encounter more types of foes):"
#			   image=portraits/book.png
##ifdef MULTIPLAYER
#                           side_for=$side_number
##endif
#                           [option]
#                  	    image="misc/red-x.png"
# 			    description=_"Return to the Game"
#			    [command]
#			      {CLEAR_VARIABLE hopliteenemycatalog_menu}
#                            [/command]
#                    	   [/option]
#			   {HOPLITE_ENEMYCATALOG_MENU}
#			 [/message]
#                         [/do]
#			[/while]
#	                [/command]
#	       [/option]
        [option]
                        image="icons/book.png"
            description="Show the list of all upgrades, and which of them you already discovered"
            [command]
            {IF_VAR side_number equals 2 (
            [then]
                {VARIABLE hoplite_showcurrentupgrades2 yes}
                {VARIABLE hoplite_showdiscovered_upgrades yes}
            [/then]
            [else]
                {VARIABLE hoplite_showcurrentupgrades yes}
                {VARIABLE hoplite_showdiscovered_upgrades yes}
            [/else]
            )}
                        [while]
                         [variable]
                            name=hoplite_showcurrentupgrades
                            equals=yes
                         [/variable]
                         [or]
                         [variable]
                            name=hoplite_showcurrentupgrades2
                            equals=yes
                         [/variable]
                         [/or]
                         [do]
                 [message]
                   speaker=narrator
                       caption="Hoplite Discovered Upgrade List"
                   image=portraits/book.png
                           message=""
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
                           [option]
                        image="misc/red-x.png"
                description=_"Return to the Game"
                [command]
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                  {CLEAR_VARIABLE hoplite_showdiscovered_upgrades}
                            [/command]
                           [/option]
                           {FORGE_UPGRADE_LIST}
                           [option]
                        image="icons/book.png~BLIT(icons/big_x.png)"
          description=_"Clear discovered upgrades."
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
          [command]
                     [message]
                           speaker=narrator
                           caption="Discovered Upgrades"
                           image=portraits/book.png
                                   message="Are you really sure you want to <span color='#ff0000'>delete</span> your <span color='#ff0000'>discovered upgrades</span> progress? (This option can't be undone)"
                   image=misc/laurel.png~SCALE(216,216)
           sound={SOUND_LIST:LICH_HIT}
#ifdef MULTIPLAYER
                                   side_for=$side_number
#endif
                                   [option]
                    image="attacks/blank-attack.png"
                    description=_"No, of course not. I clicked this by accident."
                    [command]
                      {CLEAR_VARIABLE hopliteachievement_menu}
                                    [/command]
                             [/option]
                                   [option]
                    image="attacks/wail.png"
                    description=_"<span color='#ff0000'>Yes, I know what I'm doing.</span>"
                    [command]
              {FLASH_WHITE (
              [sound]
                 name=lightning.ogg
                    [/sound])}
                                      [print]
                                         text= _ "Discovered upgrades reset!"
                                         size=25
                                         red=255
                               duration=3000
                                      [/print]
                                      {HOPLITE_CLEAR_DISCOVEREDUPGRADES $side_number}
                                    [/command]
                             [/option]
                     [/message]         
                            [/command]
                         [/option]
                         [/message]
             [/do]
            [/while]
                    [/command]
           [/option]
               [option]
			image="misc/laurel.png"
			description="Achievements"
			[command]
			{VARIABLE hopliteachievement_menu yes}
#only needed for local mp so that achievements don't desync between the two sides
      #ifdef LOCALMP
      {HOPLITE_ACHIEVEMENTLIST RETREIVE_ACHIEVEMENT}
      #endif
      {HOPLITE_CREATE_ACHIEVEMENT_DIALOG_OPTIONS}
                        [while]
                         [variable]
                            name=hopliteachievement_menu
                            equals=yes
                         [/variable]
                         [do]

           [message]
                speaker=narrator
                     caption="Achievements:"
                           message="Here are the achivements that you either completed, or are yet to complete (completed achievements are labeled with golden laurels, while incomplete ones are labeled with bronze laurels or question marks)

You currently have <span color='#a456ff'>$spartan_orbs_of_insight$side_number|| Orbs of Insight</span> (carries over between playthroughs)"
       #        image=portraits/book.png
                image=misc/laurel.png~SCALE(216,216)
                           [option]
                        image="misc/red-x.png"
          description=_"Return to the Game"
          [command]
            {CLEAR_VARIABLE hopliteachievement_menu}
                            [/command]
                         [/option]
               [insert_tag]
                   name=option
                   variable=hoplite_achievement_options
               [/insert_tag]
                           [option]
                        image="misc/laurel.png~SCALE(60,60)~BLIT(icons/big_x.png)"
          description=_"Wipe your achievement progress, all achievements you completed, orbs of insight and hints."
          [command]
                     [message]
                           speaker=narrator
                               caption="Achievements:"
                                   message="Are you really sure you want <span color='#ff0000'>delete</span> your <span color='#ff0000'>achievements, orbs of insight and achievement hints</span>? (This option cannot be undone)"
                   image=misc/laurel.png~SCALE(216,216)
           sound={SOUND_LIST:LICH_HIT}
#ifdef MULTIPLAYER
                                   side_for=$side_number
#endif
                                   [option]
                    image="attacks/blank-attack.png"
                    description=_"No, of course not. I clicked this by accident."
                    [command]
                      {CLEAR_VARIABLE hopliteachievement_menu}
                                    [/command]
                             [/option]
                                   [option]
                                  image="attacks/wail.png"
                    description=_"<span color='#ff0000'>Yes, I know what I'm doing.</span>"
                    [command]
              {FLASH_WHITE (
              [sound]
                 name=lightning.ogg
                    [/sound])}
                                      [print]
                                         text= _ "Achievements reset!"
                                         size=25
                                         red=255
                               duration=3000
                                      [/print]
                                      {HOPLITE_ACHIEVEMENTLIST CLEAR_ACHIEVEMENT}
                                      [clear_global_variable]
                                          namespace=spartan
                                          global=orbs_of_insight
                                          side=$side_number
                                          immediate=yes
                                      [/clear_global_variable]
                                      [clear_global_variable]
                                          namespace=spartan
                                          global=achievementhints_array
                                          side=$side_number
                                          immediate=yes
                                      [/clear_global_variable]
                                      {HOPLITE_ACHIEVEMENTLIST RETREIVE_ACHIEVEMENT}
                              {HOPLITE_GET_ORBS_OF_INSIGHT}
                              {HOPLITE_RETREIVE_ACHIEVEMENT_HINTS}
                              {CLEAR_VARIABLE hopliteachievement_menu}
                                    [/command]
                             [/option]
           [/message]
           [/command]
           [/option]
                           [option]
                        image="scenery/trapdoor-open.png~BLIT(icons/big_x.png)"
          description=_"Clear the starting depth options."
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
          [command]
                     [message]
                           speaker=narrator
                               caption="Achievements:"
                                   message="Are you really sure you want to <span color='#ff0000'>delete</span> your <span color='#ff0000'>starting depth</span> progress so far? (This option can't be undone)"
                   image=misc/laurel.png~SCALE(216,216)
           sound={SOUND_LIST:LICH_HIT}
#ifdef MULTIPLAYER
                                   side_for=$side_number
#endif
                                   [option]
                    image="attacks/blank-attack.png"
                    description=_"No, of course not. I clicked this by accident."
                    [command]
                      {CLEAR_VARIABLE hopliteachievement_menu}
                                    [/command]
                             [/option]
                                   [option]
                    image="attacks/wail.png"
                    description=_"<span color='#ff0000'>Yes, I know what I'm doing.</span>"
                    [command]
              {FLASH_WHITE (
              [sound]
                 name=lightning.ogg
                    [/sound])}
                                      [print]
                                         text= _ "Starting depths reset!"
                                         size=25
                                         red=255
                               duration=3000
                                      [/print]
                                      [clear_global_variable]
                                         namespace=spartan
                                         global=depth11_unlocked
                                         side=$side_number
                                         immediate=yes
                                      [/clear_global_variable]
                                      [clear_global_variable]
                                         namespace=spartan
                                         global=depth21_unlocked
                                         side=$side_number
                                         immediate=yes
                                      [/clear_global_variable]
                                      [clear_global_variable]
                                         namespace=spartan
                                         global=depth31_unlocked
                                         side=$side_number
                                         immediate=yes
                                      [/clear_global_variable]
                                      [clear_global_variable]
                                         namespace=spartan
                                         global=depth41_unlocked
                                         side=$side_number
                                         immediate=yes
                                      [/clear_global_variable]
                                      [clear_global_variable]
                                         namespace=spartan
                                         global=depth0_unlocked
                                         side=$side_number
                                         immediate=yes
                                      [/clear_global_variable]
                                      [clear_global_variable]
                                         namespace=spartan
                                         global=depth99_unlocked
                                         side=$side_number
                                         immediate=yes
                                      [/clear_global_variable]
                      {CLEAR_VARIABLE hopliteachievement_menu}
                                    [/command]
                             [/option]
                     [/message]         
                            [/command]
                         [/option]
       [/message]
                         [/do]
      [/while]
      {CLEAR_VARIABLE hoplite_achievement_options}
                  [/command]
         [/option]

           [/message]
	[/command]
    [/set_menu_item]
#ifdef MULTIPLAYER
    [lua]
        code=<<
function wesnoth.wml_conditionals.spartan_is_observer()
    local all_sides = wesnoth.sides.find()
    for index, side in ipairs(all_sides) do
        if side.controller == "human" and side.is_local then
            return false
        end
    end
    return true
end
    >>
    [/lua]
    [set_menu_item]
        id=spartan_observer_menu
        description=_"Observer Menu (WIP)"
        image=items/book2.png~CROP(21,23,27,24)~SCALE(20,20)
        synced=no
        [show_if]
            [spartan_is_observer]
            [/spartan_is_observer]
        [/show_if]
        [command]
    [message]
        speaker=narrator
        caption="Hoplite Observer menu"
        message="Select option:"
                [option]
                    image="misc/red-x.png"
            description=_"Return to the Game"
            [command]
            [/command]
        [/option]
        [option]
                        image="terrain/forge-working.png"
            description="Show the list of all upgrades Player 1 currently has"
            [command]
            {IF_VAR side_number equals 2 (
            [then]
                {VARIABLE hoplite_showcurrentupgrades2 yes}
            [/then]
            [else]
                {VARIABLE hoplite_showcurrentupgrades yes}
            [/else]
            )}
                        [while]
                         [variable]
                            name=hoplite_showcurrentupgrades
                            equals=yes
                         [/variable]
                         [or]
                         [variable]
                            name=hoplite_showcurrentupgrades2
                            equals=yes
                         [/variable]
                         [/or]
                         [do]
                 [message]
                   speaker=narrator
                       caption="Hoplite Upgrade List"
                           message=""
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
                           [option]
                        image="misc/red-x.png"
                description=_"Return to the Game"
                [command]
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                            [/command]
                           [/option]
                           {FORGE_UPGRADE_LIST}
                         [/message]
             [/do]
            [/while]
                    [/command]
           [/option]
               [option]
                        image="terrain/forge-working.png"
            description="Show the list of all upgrades Player 2 currently has."
            [show_if]
              {VARIABLE_CONDITIONAL hoplite_multiplayer equals yes}
            [/show_if]
            [command]
            {IF_VAR side_number equals 2 (
            [then]
                {VARIABLE hoplite_showcurrentupgrades yes}
            [/then]
            [else]
                {VARIABLE hoplite_showcurrentupgrades2 yes}
            [/else]
            )}
                        [while]
                         [variable]
                            name=hoplite_showcurrentupgrades
                            equals=yes
                         [/variable]
                         [or]
                         [variable]
                            name=hoplite_showcurrentupgrades2
                            equals=yes
                         [/variable]
                         [/or]
                         [do]
                 [message]
                   speaker=narrator
                       caption="Hoplite Upgrade List"
                           message=""
#ifdef MULTIPLAYER
                           side_for=$side_number
#endif
                           [option]
                        image="misc/red-x.png"
                description=_"Return to the Game"
                [command]
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades}
                  {CLEAR_VARIABLE hoplite_showcurrentupgrades2}
                            [/command]
                           [/option]
                           {FORGE_UPGRADE_LIST}
                         [/message]
             [/do]
            [/while]
                    [/command]
           [/option]
           [/message]
        [/command]
    [/set_menu_item]
#endif
    [/event]
#enddef
